import{r as j,W as F,j as e,y as h}from"./app-D6fkvZbA.js";import{I as i}from"./InputError-98kNegpX.js";import{A as J,I as c,c as p,B as f,J as m}from"./AuthenticatedLayout-CcBeljlA.js";import{C as V,a as k,b as B,c as D}from"./card-8DjiWBJf.js";import{L as n}from"./label-DRukCHiJ.js";import{S as g,a as _,b as C,c as v,d as y}from"./select-DYZRsoEN.js";import{T as L}from"./textarea-BW4cy3P8.js";import{J as O}from"./jodit-react-lRlxCfOa.js";/* empty css                   */import"./index-CP3OEn7_.js";import"./tslib.es6-M_FJ09fS.js";const Y=({certificateTypes:o,companies:u})=>{const[d,S]=j.useState(),A=j.useRef(null),{post:N,data:r,setData:l,processing:b,errors:a,reset:q,hasErrors:E,transform:w}=F({certifier_name:"",certificate_name:"",iqama:"",company_id:"",project:"",witness:"",issuedAt:"",expireAt:"",certificate_type_id:"",customFields:[],image:null}),I=s=>{s.preventDefault(),w(t=>({...t,customFields:d==null?void 0:d.custom_fields})),N(route("certificates.store"),{onSuccess:t=>{q(),m.success("Certificate Added"),setTimeout(()=>{h.get(route("certificates.index"))},3e3)},onError:t=>{m.error(t[Object.keys(t)[0]])}})};return e.jsx(J,{children:e.jsxs(V,{className:"",children:[e.jsx(k,{children:e.jsx(B,{children:"Create Certificate Type"})}),e.jsxs(D,{children:[E&&e.jsx("p",{children:"Oops"}),e.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Certificate Type"}),e.jsxs(g,{required:!0,value:r.certificate_type_id,onValueChange:s=>{l("certificate_type_id",s),S(o.find(t=>t.id==parseInt(s)))},children:[e.jsx(_,{className:"",children:e.jsx(C,{placeholder:"Select a type"})}),e.jsx(v,{children:o==null?void 0:o.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name}))})]}),e.jsx(i,{message:a.certificate_type_id})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Certifier / Equipment Name"}),e.jsx(c,{value:r.certifier_name,onChange:s=>l("certifier_name",s.target.value)}),e.jsx(i,{message:a.certifier_name})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Photo"}),e.jsx(c,{type:"file",onChange:s=>{var t;return l("image",(t=s.target.files)==null?void 0:t.item(0))}}),e.jsx(i,{message:a.image})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Certificate Name"}),e.jsx(c,{value:r.certificate_name,onChange:s=>l("certificate_name",s.target.value)}),e.jsx(i,{message:a.certificate_name})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Iqama"}),e.jsx(c,{value:r.iqama,onChange:s=>l("iqama",s.target.value)}),e.jsx(i,{message:a.iqama})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Company"}),e.jsxs(g,{required:!0,value:r.company_id,onValueChange:s=>{l("company_id",s)},children:[e.jsx(_,{className:"",children:e.jsx(C,{placeholder:"Select a company"})}),e.jsx(v,{children:u==null?void 0:u.map(s=>e.jsx(y,{value:s.id.toString(),children:s.name}))})]}),e.jsx(i,{message:a.company_id})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Project"}),e.jsx(c,{value:r.project,onChange:s=>l("project",s.target.value)}),e.jsx(i,{message:a.project})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Witness"}),e.jsx(c,{value:r.witness,onChange:s=>l("witness",s.target.value)}),e.jsx(i,{message:a.witness})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Issued At"}),e.jsx(c,{type:"date",value:r.issuedAt,onChange:s=>l("issuedAt",s.target.value)}),e.jsx(i,{message:a.issuedAt})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Expires At"}),e.jsx(c,{type:"date",value:r.expireAt,onChange:s=>l("expireAt",s.target.value)}),e.jsx(i,{message:a.expireAt})]}),e.jsx("div",{className:"font-semibold md:col-span-2 mt-10",children:"Custom fields"}),(d==null?void 0:d.custom_fields)&&(d==null?void 0:d.custom_fields.map(s=>e.jsxs("div",{className:p({"md:col-span-2":s.type=="custom"}),children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx(n,{children:s.label}),e.jsx(f,{onClick:t=>{t.preventDefault(),console.log(r.certificate_type_id,s.id),h.put(route("customFields.update",[r.certificate_type_id,s.id]),{default_value:s.default_value},{onSuccess:()=>{m.info("Updated")},onError:x=>{console.log(x),m.error(x.error)}})},size:"sm",variant:"link",children:"Set as default"})]}),e.jsxs("div",{className:p({"md:col-span-2":s.type=="custom"}),children:[s.type=="text"&&e.jsx(L,{required:!0,defaultValue:s.default_value,onChange:t=>{s.default_value=t.target.value}},s+"input"),s.type=="custom"&&e.jsx(O,{className:"prose max-w-full",ref:A,value:s.default_value,onBlur:t=>{s.default_value=t,console.log(d.custom_fields)},onChange:t=>{}}),e.jsx(i,{message:a.customFields})]},s.id)]},s.id))),e.jsx("div",{className:"md:col-span-2 pt-8",children:e.jsx(f,{disabled:b,children:"Create"})})]})]})]})})};export{Y as default};
